services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        - NVD_API_KEY=${NVD_API_KEY}
    ports:
      - "8080:8080"
      - "80:8080"
    environment:
      - DOCKER_BUILDKIT=1
      - SPRING_PROFILES_ACTIVE=h2-file
      - IPSTACK_API_KEY=${IPSTACK_API_KEY}
      - IPSTACK_API_URL=${IPSTACK_API_URL}
      - RECAPTCHA_1_SITE_KEY=${RECAPTCHA_1_SITE_KEY}
      - RECAPTCHA_1_SECRET_KEY=${RECAPTCHA_1_SECRET_KEY}
      - RECAPTCHA_1_PROJECT_ID=${RECAPTCHA_1_PROJECT_ID}
      - RECAPTCHA_1_API_KEY=${RECAPTCHA_1_API_KEY}
      - RECAPTCHA_2_SITE_KEY=${RECAPTCHA_2_SITE_KEY}
      - RECAPTCHA_2_SECRET_KEY=${RECAPTCHA_2_SECRET_KEY}
      - RECAPTCHA_2_PROJECT_ID=${RECAPTCHA_2_PROJECT_ID}
      - RECAPTCHA_2_API_KEY=${RECAPTCHA_2_API_KEY}
      - RECAPTCHA_3_SITE_KEY=${RECAPTCHA_3_SITE_KEY}
      - RECAPTCHA_3_SECRET_KEY=${RECAPTCHA_3_SECRET_KEY}
      - RECAPTCHA_3_PROJECT_ID=${RECAPTCHA_3_PROJECT_ID}
      - RECAPTCHA_3_API_KEY=${RECAPTCHA_3_API_KEY}
      - RECAPTCHA_DEFAULT_CONFIG=${RECAPTCHA_DEFAULT_CONFIG}
      - SES_USERNAME=${SES_USERNAME}
      - SES_PASSWORD=${SES_PASSWORD}
      - SES_FROM=${SES_FROM}
      - APP_BASE_URL=${APP_BASE_URL:-http://localhost}
      - LANDING_MESSAGE_EN=${LANDING_MESSAGE_EN}
      - LANDING_MESSAGE_DE_CH=${LANDING_MESSAGE_DE_CH}
      - ADMIN_PASSWORD=${ADMIN_PASSWORD}
      - USER_PASSWORD=${USER_PASSWORD}
      - ADMIN_READ_PASSWORD=${ADMIN_READ_PASSWORD}
      - ADMIN_EMAIL=${ADMIN_EMAIL}
      - USER_EMAIL=${USER_EMAIL}
      - ADMIN_READ_EMAIL=${ADMIN_READ_EMAIL}
      - JWT_ENABLED=${JWT_ENABLED:-false}
      - JWT_SECRET=${JWT_SECRET}
      - NVD_API_KEY=${NVD_API_KEY}
    volumes:
      - ./data:/app/data
      - ./data/dependency-check:/app/data/dependency-check
