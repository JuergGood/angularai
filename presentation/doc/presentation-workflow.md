# Presentation Generation Workflow

This document describes the automated workflow for generating corporate presentations from Markdown files using a custom Python generator. This approach replaces the previous Pandoc-based workflow to provide more deterministic layouting, precise corporate branding, and better table support.

## Core Components

### 1. Source Files
- **`presentation-slides.md`**: The source content in Markdown format.
  - **Note**: This file should stay as close as possible to a Pandoc-compatible format. While additional layout directives for the Python pipeline are accepted, maintaining basic Pandoc compatibility ensures a functional fallback if the advanced pipeline fails.
- **`template-company.pptx`**: The original corporate template used as a **Visual and Coordinate Reference** for branding (fonts, colors, positions).
- **`template.pptx`**: A structurally sound PowerPoint file used as a **base** by the Python generator. It is maintained to ensure compatibility with `python-pptx`.
- **`SoftwareEntwicklungAI_Python.pptx`**: The final output generated by the Python script.

### 2. Automation Utilities (Python & Java)
- **`generate_presentation.py` (Python)**: The primary generation tool. It parses the Markdown source, maps it to PowerPoint layouts, and applies corporate styling.
- **`DetailedInspector.java` (Java)**: A low-level XML analyzer used to verify that the generated PPTX follows OpenXML specifications (unique IDs, font inheritance).
- **`TemplateCreator.java` (Java)**: Historically used to initialize `template.pptx`. Its styling logic is now mirrored in the Python generator.

## The Transformation Sequence

The journey from a corporate template to a functional presentation follows these steps:

1.  **Coordinate Extraction**:
    - Precise coordinates for titles, content areas, and footers were extracted from `template-company.pptx` using `LayoutInspector.java`.
    - These values are hardcoded as constants in `generate_presentation.py` to ensure pixel-perfect alignment with the ZKB corporate design.

2.  **Parsing (`generate_presentation.py`)**:
    - The script reads `presentation-slides.md`.
    - It supports Pandoc-style title headers (`% Title`).
    - It automatically identifies slide boundaries (`---`) and titles (`# Heading`).
    - It cleans up Markdown-specific artifacts like `::: notes` or `::: columns`.

3.  **Branding Enforcement**:
    - **Font**: Enforces 'Frutiger for ZKB Light' across all text elements.
    - **Color**: Applies ZKB Blue (`#003cd3`) to titles and slide numbers.
    - **Scaling**: Images are automatically fitted into their respective placeholder boxes while preserving aspect ratio.

4.  **Table Support**:
    - Unlike Pandoc, the Python generator provides deterministic table layouting, ensuring tables fit within the slide boundaries and follow corporate typography.

## Execution Workflow

To generate the presentation, run the following command from the `presentation/presentations` directory:

```bash
cd C:\doc\sw\ai\angularai\angularai\presentation\presentations; python generate_presentation.py
```

The output will be saved to `presentation/presentations/generated/SoftwareEntwicklungAI_Python.pptx`.

## Maintenance Reference

### Updating Styles
If the corporate branding changes:
1.  Update the coordinate and style constants (e.g., `ZKB_BLUE`, `CORPORATE_FONT`) in `generate_presentation.py`.
2.  Rerun the Python generation script.

### Troubleshooting
Use the `DetailedInspector` Java utility if the generated file reports corruption:
```bash
mvn -f presentation/pom.xml compile exec:java "-Dexec.mainClass=ch.goodone.angularai.presentation.DetailedInspector" "-Dcheckstyle.skip"
```
This tool will pinpoint duplicate shape IDs or invalid XML structures.
